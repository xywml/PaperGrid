services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    image: papergrid-local:latest
    container_name: papergrid
    ports:
      - "127.0.0.1:3000:3000"
    environment:
      DATABASE_URL: "file:/data/db.sqlite"
      # 可选：为 AI 向量索引单独使用 SQLite 文件（推荐）
      # AI_VECTOR_DATABASE_URL: "file:/data/ai-index.sqlite"
      # 可选：AI 向量索引使用的 SQLite 日志模式，默认 DELETE（稳定优先）
      # SQLITE_JOURNAL_MODE: "DELETE"
      NEXTAUTH_URL: "http://localhost:3000"
      # SMTP_HOST: "smtp.example.com"
      # SMTP_PORT: "465"
      # SMTP_SECURE: "true"
      # SMTP_USER: "noreply@example.com"
      # SMTP_PASS: "your-smtp-password-or-app-token"
      # EMAIL_TO: "owner@example.com,ops@example.com"
      # EMAIL_REPLY_DENYLIST: "deny1@example.com,deny2@example.com"
      # EMAIL_UNSUBSCRIBE_SECRET: "change-this-secret"
      # EMAIL_REPLY_UNSUBSCRIBE_EXPIRE_DAYS: "365"
    volumes:
      - papergrid_data:/data
    restart: unless-stopped

volumes:
  papergrid_data:
